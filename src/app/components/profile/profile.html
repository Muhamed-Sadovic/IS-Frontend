<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="fw-bold mb-1">Moj profil</h2>
      <div class="text-muted small" *ngIf="me">
        Uloga: <span class="badge text-bg-primary">{{ me.uloga }}</span>
      </div>
    </div>
  </div>

  <div *ngIf="loading" class="text-muted">Učitavanje...</div>

  <div class="row g-4" *ngIf="!loading && me">
    <div class="col-lg-7">
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body p-4">
          <h5 class="fw-bold mb-3">Osnovni podaci</h5>

          <form (ngSubmit)="saveProfile()">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label small fw-semibold">Ime</label>
                <input class="form-control" name="ime" [(ngModel)]="profileForm.ime" required />
              </div>

              <div class="col-md-6 mb-3">
                <label class="form-label small fw-semibold">Prezime</label>
                <input
                  class="form-control"
                  name="prezime"
                  [(ngModel)]="profileForm.prezime"
                  required
                />
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label small fw-semibold">Email</label>
              <input class="form-control" [value]="me.email" disabled />
              <div class="small text-muted mt-1">Email se ne menja preko profila.</div>
            </div>

            <div class="d-flex gap-2">
              <button class="btn btn-primary fw-semibold" type="submit" [disabled]="savingProfile">
                Sačuvaj
              </button>
              <button
                class="btn btn-outline-secondary"
                type="button"
                (click)="resetProfile()"
                [disabled]="savingProfile"
              >
                Poništi
              </button>
            </div>

            <div class="alert alert-success mt-3" *ngIf="profileSuccess">{{ profileSuccess }}</div>
            <div class="alert alert-danger mt-3" *ngIf="profileError">{{ profileError }}</div>
          </form>
        </div>
      </div>
    </div>

    <div class="col-lg-5">
      <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body p-4">
          <h5 class="fw-bold mb-3">Promena lozinke</h5>

          <form (ngSubmit)="changePassword()">
            <div class="mb-3">
              <label class="form-label small fw-semibold">Stara lozinka</label>
              <input
                type="password"
                class="form-control"
                name="staraLozinka"
                [(ngModel)]="passForm.staraLozinka"
                required
              />
            </div>

            <div class="mb-3">
              <label class="form-label small fw-semibold">Nova lozinka</label>
              <input
                type="password"
                class="form-control"
                name="novaLozinka"
                [(ngModel)]="passForm.novaLozinka"
                required
                minlength="6"
              />
            </div>

            <div class="mb-3">
              <label class="form-label small fw-semibold">Potvrdi novu lozinku</label>
              <input
                type="password"
                class="form-control"
                name="potvrdaNove"
                [(ngModel)]="passForm.potvrdaNove"
                required
                minlength="6"
              />
            </div>

            <button
              class="btn btn-outline-primary fw-semibold"
              type="submit"
              [disabled]="savingPass"
            >
              Promeni lozinku
            </button>

            <div class="alert alert-success mt-3" *ngIf="passSuccess">{{ passSuccess }}</div>
            <div class="alert alert-danger mt-3" *ngIf="passError">{{ passError }}</div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
