<div class="register-page">
  <div class="container">
    <div class="row justify-content-center align-items-center min-vh-100 g-4">
      <div class="col-md-7 col-lg-5">
        <div class="card register-card shadow-lg border-0">
          <ng-container *ngIf="!prikaziVerifikaciju">
            <div class="card-header text-center border-0 bg-white pt-4">
              <h4 class="fw-bold mb-1">Kreiranje naloga</h4>
              <p class="text-muted small mb-0">DentalCentar – registracija pacijenta</p>
            </div>

            <div class="card-body px-4 py-4">
              <form (ngSubmit)="potvrdiRegistraciju()">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label small fw-semibold">Ime</label>
                    <input
                      type="text"
                      name="ime"
                      class="form-control"
                      [(ngModel)]="noviKorisnik.ime"
                      required
                      #imeField="ngModel"
                      [class.is-invalid]="imeField.invalid && (imeField.dirty || imeField.touched)"
                      placeholder="Unesite ime"
                    />
                    <div
                      *ngIf="imeField.invalid && (imeField.dirty || imeField.touched)"
                      class="text-danger small mt-1"
                    >
                      Ime je obavezno.
                    </div>
                  </div>

                  <div class="col-md-6 mb-3">
                    <label class="form-label small fw-semibold">Prezime</label>
                    <input
                      type="text"
                      name="prezime"
                      class="form-control"
                      [(ngModel)]="noviKorisnik.prezime"
                      required
                      #prezimeField="ngModel"
                      [class.is-invalid]="
                        prezimeField.invalid && (prezimeField.dirty || prezimeField.touched)
                      "
                      placeholder="Unesite prezime"
                    />
                    <div
                      *ngIf="prezimeField.invalid && (prezimeField.dirty || prezimeField.touched)"
                      class="text-danger small mt-1"
                    >
                      Prezime je obavezno.
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label small fw-semibold">Email adresa</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light"><i class="bi bi-envelope"></i></span>

                    <input
                      type="email"
                      name="email"
                      class="form-control"
                      [(ngModel)]="noviKorisnik.email"
                      required
                      email
                      #emailField="ngModel"
                      [class.is-invalid]="
                        emailField.invalid && (emailField.dirty || emailField.touched)
                      "
                      placeholder="ime@primer.com"
                    />
                  </div>

                  <div
                    *ngIf="emailField.invalid && (emailField.dirty || emailField.touched)"
                    class="text-danger small mt-1"
                  >
                    <div *ngIf="emailField.errors?.['required']">Email je obavezan.</div>
                    <div *ngIf="emailField.errors?.['email']">Format emaila nije ispravan.</div>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label small fw-semibold">Lozinka</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light"><i class="bi bi-lock"></i></span>

                    <input
                      type="password"
                      name="lozinka"
                      class="form-control"
                      [(ngModel)]="noviKorisnik.lozinka"
                      required
                      minlength="6"
                      #passField="ngModel"
                      [class.is-invalid]="
                        passField.invalid && (passField.dirty || passField.touched)
                      "
                      placeholder="••••••••"
                    />
                  </div>

                  <div
                    *ngIf="passField.invalid && (passField.dirty || passField.touched)"
                    class="text-danger small mt-1"
                  >
                    <div *ngIf="passField.errors?.['required']">Lozinka je obavezna.</div>
                    <div *ngIf="passField.errors?.['minlength']">Mora imati bar 6 karaktera.</div>
                  </div>
                </div>

                <button type="submit" class="btn btn-primary w-100 py-2 fw-semibold mt-2">
                  Registruj se
                </button>

                <div class="text-center mt-4 small">
                  <span class="text-muted">Već imate nalog?</span>
                  <a routerLink="/login" class="text-primary fw-semibold text-decoration-none ms-1"
                    >Prijavite se</a
                  >
                </div>
              </form>
            </div>
          </ng-container>

          <ng-container *ngIf="prikaziVerifikaciju">
            <div class="card-body px-4 py-5 text-center animate__animated animate__fadeIn">
              <div class="mb-4">
                <i class="bi bi-shield-check text-primary" style="font-size: 3rem"></i>
              </div>
              <h4 class="fw-bold mb-2">Potvrda identiteta</h4>
              <p class="text-muted small mb-4">
                Poslali smo četvorocifreni kod na adresu:<br />
                <span class="text-dark fw-bold">{{ noviKorisnik.email }}</span>
              </p>

              <div class="d-flex justify-content-center gap-3 mb-4">
                <input
                  type="text"
                  maxlength="1"
                  class="form-control otp-input"
                  [(ngModel)]="otpCode[0]"
                  (keyup)="moveFocus($event, 0)"
                  name="otp0"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="form-control otp-input"
                  [(ngModel)]="otpCode[1]"
                  (keyup)="moveFocus($event, 1)"
                  name="otp1"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="form-control otp-input"
                  [(ngModel)]="otpCode[2]"
                  (keyup)="moveFocus($event, 2)"
                  name="otp2"
                />
                <input
                  type="text"
                  maxlength="1"
                  class="form-control otp-input"
                  [(ngModel)]="otpCode[3]"
                  (keyup)="moveFocus($event, 3)"
                  name="otp3"
                />
              </div>

              <button (click)="potvrdiKod()" class="btn btn-primary w-100 py-2 fw-semibold mb-3">
                Aktiviraj nalog
              </button>

              <button
                (click)="prikaziVerifikaciju = false"
                class="btn btn-link btn-sm text-decoration-none text-muted"
              >
                <i class="bi bi-arrow-left me-1"></i> Nazad na izmenu podataka
              </button>
            </div>
          </ng-container>
        </div>

        <div class="text-center mt-3 small text-muted">© {{ currentYear }} DentalCentar</div>
      </div>

      <div class="col-lg-5 d-none d-lg-block">
        <div class="card border-0 shadow-sm rounded-4 p-4">
          <h5 class="fw-bold mb-2">Brže i lakše</h5>
          <p class="text-muted mb-4">
            Zakazivanje termina, terapije i računi — sve na jednom mestu.
          </p>

          <div class="d-flex gap-3 mb-3">
            <i class="bi bi-calendar2-check text-primary fs-4"></i>
            <div>
              <div class="fw-semibold">Zakazivanje termina</div>
              <div class="small text-muted">Izaberite termin u par klikova.</div>
            </div>
          </div>

          <div class="d-flex gap-3 mb-3">
            <i class="bi bi-bell text-primary fs-4"></i>
            <div>
              <div class="fw-semibold">Podsetnici</div>
              <div class="small text-muted">Ne propuštate pregled.</div>
            </div>
          </div>

          <div class="d-flex gap-3">
            <i class="bi bi-receipt text-primary fs-4"></i>
            <div>
              <div class="fw-semibold">Računi i evidencija</div>
              <div class="small text-muted">Sve uredno sačuvano u sistemu.</div>
            </div>
          </div>

          <hr class="my-4" />
          <div class="small text-muted">
            <i class="bi bi-shield-lock me-1"></i>
            Vaši podaci su sigurni i dostupni samo vama.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
